[{"content":"åˆ›å»ºæ–°ç½‘ç«™ hugo new site ç½‘ç«™åå­— hugoå¼€å¯æœåŠ¡ hugo server --buildDrafts hugo serve hugo server -D ä¸‰ç§æ–¹å¼éƒ½å¯ä»¥\næ–°å»ºæ–‡ä»¶ hugo new æ–‡ä»¶ç›®å½•/æ–‡ä»¶å.zh.md hugo new æ–‡ä»¶ç›®å½•/æ–‡ä»¶ç›®å½•/æ–‡ä»¶å.zh.md æ–°å»ºç« èŠ‚ hugo new --kind chapter æ–‡ä»¶ç›®å½•/_index.zh.md æ–‡ä»¶_index.zh.mdé‡Œé¢æ”¹ä¸º chapter = true\næ·»åŠ ä¸»é¢˜ // è¿›å…¥ä¸»é¢˜ç›®å½• cd themes/ // å…‹éš†learnä¸»é¢˜ git clone https://github.com/matcornic/hugo-theme-learn.git æŠŠexampleSiteä¸‹é¢çš„config.tomlæ–‡ä»¶å¤åˆ¶åˆ°ç«™ç‚¹ä¸‹,ä¿®æ”¹config.tomlæ–‡ä»¶é‡Œé¢çš„themes = \u0026ldquo;learn\u0026rdquo;\næ‰“åŒ…éƒ¨ç½² hugo # hugo -F --cleanDestinationDir # åŠ äº†ä¸Šè¿°å‚æ•°è¡¨ç¤ºè¡¨ç¤ºæ¯æ¬¡ç”Ÿæˆçš„publicéƒ½æ˜¯å…¨æ–°çš„ï¼Œä¼šè¦†ç›–åŸæ¥çš„ã€‚ ç”Ÿæˆæ–‡ä»¶å¤¹publicï¼Œå…¶ä¸­åŒ…å«ç½‘ç«™çš„æ‰€æœ‰é™æ€å†…å®¹ï¼Œå¯ä»¥éƒ¨ç½²åœ¨ä»»ä½• Web æœåŠ¡å™¨ä¸Šã€‚\n","permalink":"/posts/tech/hugo%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/","summary":"åˆ›å»ºæ–°ç½‘ç«™ hugo new site ç½‘ç«™åå­— hugoå¼€å¯æœåŠ¡ hugo server --buildDrafts hugo serve hugo server -D ä¸‰ç§æ–¹å¼éƒ½å¯ä»¥ æ–°å»ºæ–‡ä»¶ hugo new æ–‡ä»¶ç›®å½•/æ–‡ä»¶å.zh.md hugo new æ–‡ä»¶ç›®å½•/æ–‡ä»¶ç›®å½•/æ–‡ä»¶å.zh.md æ–°å»ºç« èŠ‚ hugo new --kind chapter æ–‡ä»¶ç›®å½•/_index.zh.md æ–‡ä»¶_index.zh.mdé‡Œé¢æ”¹ä¸º chapter = true æ·»åŠ ä¸»é¢˜ // è¿›å…¥ä¸»é¢˜ç›®å½• cd themes/ // å…‹éš†le","title":"Hugoå¸¸ç”¨å‘½ä»¤"},{"content":"æ³¨ï¼šåªæä¾›éƒ¨ç½²ä¸‰å°MySQLæœåŠ¡å™¨çš„æµç¨‹ï¼ŒåŸºäºMySQLçš„MGRç‰¹æ€§ã€‚æ²¡æœ‰ä¸»ä»å…³ç³»ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€æ ·çš„ã€‚ éƒ¨ç½²å¤šå°çš„æœåŠ¡æ–¹å¼ä¸€æ ·ï¼Œåªéœ€ç®€å•çš„ä¿®æ”¹å‡ ä¸ªåœ°æ–¹çš„é…ç½®ã€‚\næ¡ˆä¾‹ç¯å¢ƒè¯´æ˜ èŠ‚ç‚¹ ip ç«¯å£ ä½œç”¨ èŠ‚ç‚¹1 (chenxiaoju3) 192.168.1.89 3306 MySQLéƒ¨ç½² èŠ‚ç‚¹2 (chenxiaoju4ï¼‰ 192.168.1.91 3306ï¼Œ6033 MySQLéƒ¨ç½²+ProxySQL èŠ‚ç‚¹3(chenxiaoju17) 192.168.1.17 3306 MySQLéƒ¨ç½² å®‰è£…å„èŠ‚ç‚¹çš„MySQLæœåŠ¡ ä¸€ã€å»ºè®¾ç›®å½•å’Œç£ç›˜æŒ‚è½½ åœ¨å®¿ä¸»æœºä¸Šå»ºç«‹å¦‚ä¸‹ç›®å½•\n/dascom/mysql/config /dascom/mysql/db å‘½ä»¤ï¼š\nmkdir -p /dascom/mysql/config /dascom/mysql/db ç›®å½•è¯´æ˜ï¼š |-/dascom v10æ‰€æœ‰æœåŠ¡ç›®å½• |-mysql è¡¨ç¤ºmysqlæ•°æ®åº“æœåŠ¡ï¼Œå¯¹åº”çš„æœåŠ¡çš„å¯åŠ¨è„šæœ¬ç­‰éƒ½ä¼šæ”¾åˆ°è¿™é‡Œ |-config mysqlæ•°æ®åº“çš„é…ç½®è·¯å¾„ |-db æ•°æ®åº“æ•°æ®å­˜æ”¾è·¯å¾„ ::: ğŸ¤” é‡è¦æç¤º\ndbç›®å½•æ˜¯æ•°æ®å­˜æ”¾çš„ç›®å½•ï¼Œä¸€å¼€å§‹ç£ç›˜æŒ‚è½½è¦åˆ†é…å¥½åˆç†çš„ç©ºé—´ã€‚å¦åˆ™åæœŸç©ºé—´æ»¡äº†ä¸å¥½å¤„ç†ã€‚ :::\näºŒã€ä¸Šä¼ é…ç½®æ–‡ä»¶å’Œå¯åŠ¨è„šæœ¬ æ³¨ï¼šä¸‰å°MySQLèŠ‚ç‚¹æœåŠ¡å™¨éƒ½ä¸€æ ·çš„æ­¥éª¤ã€‚\n2.1 ä¸Šä¼ é…ç½®æ–‡ä»¶ åˆ›å»ºé…ç½®æ–‡ä»¶æ”¾åˆ°/dascom/mysql/configç›®å½•ä¸‹ï¼Œåç§°å¦‚ä¸‹\nconfig.cnf å†…å®¹é…ç½®è§£é‡Šï¼š\n[mysqld] #å¿½ç•¥å¤§å°å†™ lower_case_table_names=1 # æœ€å¤§è¿æ¥æ•° max_connections=1024 # æœåŠ¡ç«¯ä½¿ç”¨çš„å­—ç¬¦é›† character-set-server=utf8mb4 # å¯†ç æ’ä»¶ authentication_policy=mysql_native_password #GTID: #å½“å‰èŠ‚ç‚¹çš„idã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¸èƒ½ä¸€æ · server_id=1 gtid_mode=on enforce_gtid_consistency=on #binlog binlog_checksum=NONE log_bin=mysql-bin log_replica_updates=1 binlog_format=row sync_source_info=1 sync_binlog=1 #relay log skip_replica_start=1 #æ·»åŠ æ’ä»¶ plugin_load_add=\u0026#39;group_replication.so\u0026#39; #MGRä¸»è¦é…ç½® #ç»„çš„åå­—å¯ä»¥éšä¾¿èµ·,ä½†ä¸èƒ½ç”¨ä¸»æœºçš„GTID! æ‰€æœ‰èŠ‚ç‚¹çš„è¿™ä¸ªç»„åå¿…é¡»ä¿æŒä¸€è‡´ï¼ loose-group_replication_group_name=\u0026#34;d6eee5a1-4124-11ec-bbec-0242ac110003\u0026#34; #ä¸ºäº†é¿å…æ¯æ¬¡å¯åŠ¨è‡ªåŠ¨å¼•å¯¼å…·æœ‰ç›¸åŒåç§°çš„ç¬¬äºŒä¸ªç»„,æ‰€ä»¥è®¾ç½®ä¸ºOFFã€‚ loose-group_replication_start_on_boot=off #å½“å‰æœºå™¨çš„åœ°å€,åé¢çš„ç«¯å£æ ¹æ®å®˜ç½‘ä»¥ä¸Š24901,24901...éšä¾¿å³å¯ã€‚ loose-group_replication_local_address=\u0026#34;192.168.1.89:24901\u0026#34; #ç»„çš„å…¨éƒ¨åœ°å€ loose-group_replication_group_seeds=\u0026#34;192.168.1.89:24901,192.168.1.91:24901\u0026#34; loose-group_replication_bootstrap_group=off loose-group_replication_single_primary_mode=off #å¼€å¯å¤šä¸»æ¨¡å¼çš„å‚æ•° loose-group_replication_enforce_update_everywhere_checks=on #è¯»å†™ä¸€è‡´æ€§çš„ç­–ç•¥é…ç½®ï¼Œæ•°æ®å»¶è¿Ÿçš„å…³é”®é…ç½® group_replication_consistency=BEFORE 2.2 ä¸Šä¼ å¯åŠ¨è„šæœ¬ åˆ›å»ºå¯åŠ¨è„šæœ¬åˆ°æœåŠ¡å™¨/dascom/mysqlè·¯å¾„ä¸‹ã€‚æ–‡ä»¶åå­—ï¼š\ndascom-mysql-deploy ä¿®æ”¹æ–‡ä»¶å¯æ‰§è¡Œ\nchmod +x dascom-mysql-deploy å¯åŠ¨è„šæœ¬å‘½ä»¤è§£é‡Šï¼š\n#!/bin/bash #author :chenxj docker run \\ --name dascom-mysql \\ #å®¹å™¨åå­— --privileged=true \\ #æå‡å®¹å™¨æƒé™ --restart=always \\ #éšdockerå¯åŠ¨ --net=host \\ #dockerçš„ç½‘ç»œæ¡¥æ¥æ¨¡å¼ï¼Œ=hostè¡¨ç¤ºå’Œå®¿ä¸»æœºåœ¨åŒä¸€ä¸ªç½‘ç»œä¸­ï¼Œä½¿ç”¨å®¿ä¸»æœºçš„IPå’Œç«¯å£ -v /dascom/mysql/db:/var/lib/mysql \\ #æŒ‚è½½æ•°æ®å­˜å‚¨ç›®å½• -v /dascom/mysql/config:/etc/mysql/conf.d \\ #é…ç½®æ–‡ä»¶çš„æ˜ å°„ -v /etc/localtime:/etc/localtime \\ #å®¹å™¨æ—¶åŒºé—®é¢˜ -e MYSQL_ROOT_PASSWORD=dascom \\ #æ•°æ®åº“rootç”¨æˆ·çš„å¯†ç é…ç½® -d mysql:8.0.27 --lower_case_table_names=1 2.3 ä¿®æ”¹å„èŠ‚ç‚¹çš„hostsæ–‡ä»¶ï¼ˆé‡è¦ï¼‰ ä¿®æ”¹å„èŠ‚ç‚¹çš„hostsæ–‡ä»¶ï¼Œé…ç½®ç»„å†…èŠ‚ç‚¹çš„ä¸»æœºåå’ŒIP\nvim /etc/hosts è·å–ä¸»æœºåçš„å‘½ä»¤\nhostname æ·»åŠ ä»¥ä¸‹å†…å®¹\n... 192.168.1.89 chenxiaoju3 192.168.1.91 chenxiaoju4 192.178.1.17 chenxiaoju é‡å¯ç½‘ç»œ\nservice network restart ä¸‰ã€ ä¿®æ”¹é…ç½®ï¼Œå¯åŠ¨å¹¶æ‰§è¡Œç»„åŒæ­¥æ“ä½œ 3.1 èŠ‚ç‚¹1 192.168.1.89ï¼ˆå¼•å¯¼èŠ‚ç‚¹ï¼‰ 1ï¼‰ä¿®æ”¹é…ç½®æ–‡ä»¶ ä¿®æ”¹é…ç½®æ–‡ä»¶çš„ä¸­ä»¥ä¸‹å‡ é¡¹ä¸ºä»¥ä¸‹å€¼\n#å½“å‰èŠ‚ç‚¹çš„idã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¸èƒ½ä¸€æ · server_id=1 #å½“å‰æœºå™¨çš„åœ°å€,åé¢çš„ç«¯å£æ ¹æ®å®˜ç½‘ä»¥ä¸Š24901,24901...éšä¾¿å³å¯ã€‚ loose-group_replication_local_address=\u0026#34;192.168.1.89:24901\u0026#34; #ç»„çš„å…¨éƒ¨åœ°å€ loose-group_replication_group_seeds =\u0026#34;192.168.1.89:24901,192.168.1.91:24902,192.168.1.17:24903\u0026#34; 2ï¼‰å¯åŠ¨æœåŠ¡ ./dascom-mysql-deploy 3) ä½¿ç”¨MySQLå®¢æˆ·ç«¯å·¥å…·è¿æ¥ï¼Œé…ç½®MGR å¦‚æœæœ‰é˜²ç«å¢™ï¼Œè®°å¾—å¼€å‘3306 å’Œ 24901ç«¯å£\n192.168.1.89:3306 å·¥å…·è¿æ¥ä¸Šä»¥åï¼Œç›´æ¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œä¸€ä¸ªä¸€ä¸ª(â€œ;â€å·ç»“å°¾)çš„è¿è¡Œã€‚(#å¼€å¤´çš„çœç•¥)\n#åˆ›å»ºå¤åˆ¶è´¦æˆ· SET SQL_LOG_BIN=0; CREATE USER repl@\u0026#39;%\u0026#39; IDENTIFIED BY \u0026#39;repl\u0026#39;; GRANT REPLICATION SLAVE ON *.* TO repl@\u0026#39;%\u0026#39; WITH GRANT OPTION; FLUSH PRIVILEGES; SET SQL_LOG_BIN=1; #é…ç½®å¤åˆ¶ä¿¡æ¯å‘½ä»¤ CHANGE REPLICATION SOURCE TO SOURCE_USER=\u0026#39;repl\u0026#39;, SOURCE_PASSWORD=\u0026#39;repl\u0026#39; FOR CHANNEL \u0026#39;group_replication_recovery\u0026#39;; #å¼•å¯¼èŠ‚ç‚¹éœ€è¦è®¾ç½®ONï¼Œå¦åˆ™ä¸€ç›´è¯†åˆ«ä¸åˆ°å…¶ä»–èŠ‚ç‚¹ï¼ˆå› ä¸ºå…¶ä»–èŠ‚ç‚¹è¿˜æ²¡æœ‰å¯åŠ¨ï¼‰ SET GLOBAL group_replication_bootstrap_group=ON; #å¼€å¯ç»„å¤åˆ¶ START GROUP_REPLICATION; #æ¢å¤å‚æ•° SET GLOBAL group_replication_bootstrap_group=OFF; #æŸ¥çœ‹ç»„çŠ¶æ€ SELECT * FROM performance_schema.replication_group_members; æœ€ç»ˆå‡ºç°ä»¥ä¸‹ç•Œé¢ï¼ŒçŠ¶æ€æ˜¯ONLINEè¡¨ç¤ºæˆåŠŸï¼\n3.2 èŠ‚ç‚¹2 192.168.1.91ï¼ˆå…¶ä»–èŠ‚ç‚¹ï¼‰ 1ï¼‰ä¿®æ”¹é…ç½®æ–‡ä»¶ ä¿®æ”¹é…ç½®æ–‡ä»¶çš„ä¸­ä»¥ä¸‹å‡ é¡¹ä¸ºä»¥ä¸‹å€¼\n#å½“å‰èŠ‚ç‚¹çš„idã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¸èƒ½ä¸€æ · server_id=2 #å½“å‰æœºå™¨çš„åœ°å€,åé¢çš„ç«¯å£æ ¹æ®å®˜ç½‘ä»¥ä¸Š24901,24901...éšä¾¿å³å¯ã€‚ loose-group_replication_local_address=\u0026#34;192.168.1.91:24902\u0026#34; #ç»„çš„å…¨éƒ¨åœ°å€ loose-group_replication_group_seeds =\u0026#34;192.168.1.89:24901,192.168.1.91:24902,192.168.1.17:24903\u0026#34; 2ï¼‰å¯åŠ¨æœåŠ¡ ./dascom-mysql-deploy 3) ä½¿ç”¨MySQLå®¢æˆ·ç«¯å·¥å…·è¿æ¥ï¼Œé…ç½®MGR å¦‚æœæœ‰é˜²ç«å¢™ï¼Œè®°å¾—å¼€å‘3306å’Œ24902ç«¯å£\n192.168.1.91:3306 å·¥å…·è¿æ¥ä¸Šä»¥åï¼Œç›´æ¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œä¸€ä¸ªä¸€ä¸ª(â€œ;â€å·ç»“å°¾)çš„è¿è¡Œã€‚(#å¼€å¤´çš„çœç•¥)\n#åˆ›å»ºå¤åˆ¶è´¦æˆ· SET SQL_LOG_BIN=0; CREATE USER repl@\u0026#39;%\u0026#39; IDENTIFIED BY \u0026#39;repl\u0026#39;; GRANT REPLICATION SLAVE ON *.* TO repl@\u0026#39;%\u0026#39; WITH GRANT OPTION; FLUSH PRIVILEGES; SET SQL_LOG_BIN=1; #é…ç½®å¤åˆ¶ä¿¡æ¯å‘½ä»¤ CHANGE REPLICATION SOURCE TO SOURCE_USER=\u0026#39;repl\u0026#39;, SOURCE_PASSWORD=\u0026#39;repl\u0026#39; FOR CHANNEL \u0026#39;group_replication_recovery\u0026#39;; #é‡ç½®åŒæ­¥æ—¥å¿—æ–‡ä»¶ RESET MASTER; #å¼€å¯ç»„å¤åˆ¶ START GROUP_REPLICATION; #æŸ¥çœ‹ç»„çŠ¶æ€ SELECT * FROM performance_schema.replication_group_members; æœ€ç»ˆå‡ºç°ä»¥ä¸‹ç•Œé¢ï¼ŒçŠ¶æ€æ˜¯ONLINEè¡¨ç¤ºæˆåŠŸï¼\n3.3 èŠ‚ç‚¹2 192.168.1.17ï¼ˆå…¶ä»–èŠ‚ç‚¹ï¼‰ 1ï¼‰ä¿®æ”¹é…ç½®æ–‡ä»¶ ä¿®æ”¹é…ç½®æ–‡ä»¶çš„ä¸­ä»¥ä¸‹å‡ é¡¹ä¸ºä»¥ä¸‹å€¼\n#å½“å‰èŠ‚ç‚¹çš„idã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¸èƒ½ä¸€æ · server_id=2 #å½“å‰æœºå™¨çš„åœ°å€,åé¢çš„ç«¯å£æ ¹æ®å®˜ç½‘ä»¥ä¸Š24901,24901...éšä¾¿å³å¯ã€‚ loose-group_replication_local_address=\u0026#34;192.168.1.19:24903\u0026#34; #ç»„çš„å…¨éƒ¨åœ°å€ loose-group_replication_group_seeds =\u0026#34;192.168.1.89:24901,192.168.1.91:24902,192.168.1.17:24903\u0026#34; 2ï¼‰å¯åŠ¨æœåŠ¡ ./dascom-mysql-deploy 3) ä½¿ç”¨MySQLå®¢æˆ·ç«¯å·¥å…·è¿æ¥ï¼Œé…ç½®MGR å¦‚æœæœ‰é˜²ç«å¢™ï¼Œè®°å¾—å¼€å‘3306å’Œ24902ç«¯å£\n192.168.1.17:3306 å·¥å…·è¿æ¥ä¸Šä»¥åï¼Œç›´æ¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œä¸€ä¸ªä¸€ä¸ª(â€œ;â€å·ç»“å°¾)çš„è¿è¡Œã€‚(#å¼€å¤´çš„çœç•¥)\n#åˆ›å»ºå¤åˆ¶è´¦æˆ· SET SQL_LOG_BIN=0; CREATE USER repl@\u0026#39;%\u0026#39; IDENTIFIED BY \u0026#39;repl\u0026#39;; GRANT REPLICATION SLAVE ON *.* TO repl@\u0026#39;%\u0026#39; WITH GRANT OPTION; FLUSH PRIVILEGES; SET SQL_LOG_BIN=1; #é…ç½®å¤åˆ¶ä¿¡æ¯å‘½ä»¤ CHANGE REPLICATION SOURCE TO SOURCE_USER=\u0026#39;repl\u0026#39;, SOURCE_PASSWORD=\u0026#39;repl\u0026#39; FOR CHANNEL \u0026#39;group_replication_recovery\u0026#39;; #é‡ç½®åŒæ­¥æ—¥å¿—æ–‡ä»¶ RESET MASTER; #å¼€å¯ç»„å¤åˆ¶ START GROUP_REPLICATION; #æŸ¥çœ‹ç»„çŠ¶æ€ SELECT * FROM performance_schema.replication_group_members; æœ€ç»ˆå‡ºç°ä»¥ä¸‹ç•Œé¢ï¼ŒçŠ¶æ€æ˜¯ONLINEè¡¨ç¤ºæˆåŠŸï¼\nç°åœ¨ï¼Œéšä¾¿åœ¨å…¶ä¸­ä¸€å°ä¸Šæ·»åŠ æ•°æ®ï¼Œå¦å¤–ä¸¤å°éƒ½ä¼šåŒæ­¥æ•°æ®ï¼ï¼ï¼\nå®‰è£…ProxySQLæœåŠ¡ ::: ğŸ¤” ç‰ˆæœ¬\nProxySQL: 2.3.2 :::\nProxySQLå®˜æ–¹æ–‡æ¡£\nä¸€ã€å»ºè®¾ç›®å½•å’Œç£ç›˜æŒ‚è½½ åœ¨å®¿ä¸»æœºä¸Šå»ºç«‹å¦‚ä¸‹ç›®å½•\n/dascom/proxysql/config /dascom/proxysql/db å‘½ä»¤ï¼š\nmkdir -p /dascom/proxysql/config /dascom/proxysql/db ç›®å½•è¯´æ˜ï¼š |-/dascom v10æ‰€æœ‰æœåŠ¡ç›®å½• |-proxysql è¡¨ç¤ºProxySQLæ•°æ®åº“æœåŠ¡ï¼Œå¯¹åº”çš„æœåŠ¡çš„å¯åŠ¨è„šæœ¬ç­‰éƒ½ä¼šæ”¾åˆ°è¿™é‡Œ |-config ProxySQLæ•°æ®åº“çš„é…ç½®è·¯å¾„ |-db æ•°æ®åº“æ•°æ®å­˜æ”¾è·¯å¾„ ::: ğŸ¤” é‡è¦æç¤º\ndbç›®å½•æ˜¯æ•°æ®å­˜æ”¾çš„ç›®å½•ï¼Œä¸€å¼€å§‹ç£ç›˜æŒ‚è½½è¦åˆ†é…å¥½åˆç†çš„ç©ºé—´ã€‚å¦åˆ™åæœŸç©ºé—´æ»¡äº†ä¸å¥½å¤„ç†ã€‚ :::\näºŒã€ä¸Šä¼ é…ç½®æ–‡ä»¶å¹¶ä¿®æ”¹ åˆ›å»ºé…ç½®æ–‡ä»¶åˆ°/dascom/proxysql/configç›®å½•ä¸‹ï¼Œæ–‡ä»¶åç§°\nproxysql.cnf å†…å®¹é…ç½®è§£é‡Šï¼š\n#æ•°æ®å­˜æ”¾ç›®å½•ï¼Œé»˜è®¤ä¸ç”¨ä¿®æ”¹ï¼Œä¼šæŒ‚è½½åˆ°ä¸»æœºçš„/dascom/proxysql/dbç›®å½• datadir=\u0026#34;/var/lib/proxysql\u0026#34; #å…¨å±€ä¸»é…ç½®ä¿¡æ¯ admin_variables= { admin_credentials=\u0026#34;admin:admin;radmin:radmin\u0026#34; #æ§åˆ¶å°ç”¨æˆ·å’Œå¯†ç  adminåªèƒ½æœ¬æœºè®¿é—®ï¼Œradminå¯ä»¥è¿œç¨‹è®¿é—® mysql_ifaces=\u0026#34;0.0.0.0:6032\u0026#34; #æ§åˆ¶å°ç«¯å£ web_enabled=\u0026#34;true\u0026#34; #å¯ç”¨webç›‘æ§ç•Œé¢ } mysql_variables= { threads=4 max_connections=3000 default_query_delay=0 default_query_timeout=36000000 have_compress=true poll_timeout=2000 interfaces=\u0026#34;0.0.0.0:6033\u0026#34; #é¡¹ç›®è¿æ¥çš„ç«¯å£ 6033 å’Œ mysql 3306ã€‚ å‘ç°è§„å¾‹äº†å—ï¼Ÿ default_schema=\u0026#34;information_schema\u0026#34; stacksize=1048576 server_version=\u0026#34;8.0.27\u0026#34; connect_timeout_server=3000 monitor_username=\u0026#34;root\u0026#34; monitor_password=\u0026#34;dascom\u0026#34; monitor_history=600000 monitor_connect_interval=60000 monitor_ping_interval=10000 monitor_read_only_interval=1500 monitor_read_only_timeout=500 ping_interval_server_msec=120000 ping_timeout_server=500 commands_stats=true sessions_sort=true connect_retries_on_failure=10 } #mysql æœåŠ¡çš„é…ç½®ï¼Œå‡ å°æœåŠ¡é…ç½®å‡ æ¡æ•°æ® #hostgroupå¿…é¡»ä¸€è‡´ weightæƒé‡ max_connectionsæœ€å¤§è¿æ¥æ•°ï¼Œéœ€è¦å°äºmysqlé…ç½®çš„æœ€å¤§è¿æ¥æ•°ï¼Œå¦åˆ™ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šæŠ¥é”™ï¼Œé»˜è®¤å€¼1000 mysql_servers = ( { address=\u0026#34;192.168.1.89\u0026#34; , port=3306 , hostgroup=1, weight=10, max_connections=1000 }, { address=\u0026#34;192.168.1.91\u0026#34; , port=3306 , hostgroup=1, weight=10, max_connections=1000 }, { address=\u0026#34;192.168.1.17\u0026#34; , port=3306 , hostgroup=1, weight=10, max_connections=1000 } ) # mysqlæœåŠ¡è¿æ¥çš„ç”¨æˆ·é…ç½® # ç”¨æˆ·çš„é…ç½®ä¸€å®šæ˜¯åç«¯çš„MySQLçš„è¿æ¥ç”¨æˆ· #default_hostgroup ç®¡ç†çš„ç»„å°±æ˜¯ä¸Šé¢serversçš„hostgroupï¼Œå¦åˆ™ä½¿ç”¨è¯¥ç”¨æˆ·è¿ä¸ä¸Šserversçš„æœåŠ¡ã€‚ #max_connections æœ€å¤§è¿æ¥æ•°ï¼Œä¸€èˆ¬å°±æ˜¯ä¸Šé¢serversçš„æœ€å¤§è¿æ¥æ•°æ€»å’Œ mysql_users: ( { username = \u0026#34;root\u0026#34; password = \u0026#34;dascom\u0026#34; default_hostgroup = 1 active = 1 max_connections=3000 } ) ğŸ¤” éœ€è¦ä¿®æ”¹çš„é…ç½®\n1.mysql_serverså—ï¼Œ é…ç½®åç«¯MySQLçš„æ‰€æœ‰æœåŠ¡ï¼Œæœ€å¤§è¿æ¥æ•°ç­‰ä¿¡æ¯ 2.mysql_userså— ä¸‰ã€ä¸Šä¼ å¯åŠ¨è„šæœ¬ï¼Œå¹¶å¯åŠ¨ åˆ›å»ºå¯åŠ¨è„šæœ¬åˆ°/dascom/proxysqlç›®å½•ä¸‹ï¼Œåç§°å¦‚ä¸‹ï¼š\ndascom-proxysql-deploy ä¿®æ”¹å¯æ‰§è¡Œï¼š\nchmod +x dascom-proxysql-deploy è„šæœ¬è§£é‡Šï¼š\n#!/bin/bash #author: chenxj docker run \\ --name dascom-proxysql \\ #å®¹å™¨å --privileged=true \\ --restart=always \\ #éšdockerå¯åŠ¨ -p 6032:6032 \\ #æ˜ å°„æ§åˆ¶å°ç«¯å£ -p 6033:6033 \\ #æ˜ å°„å¹³å°è¿æ¥ç«¯å£ -p 6080:6080 \\ #æ˜ å°„webç›‘æ§é¡µé¢ç«¯å£ -v /dascom/proxysql/config/proxysql.cnf:/etc/proxysql.cnf \\ #é…ç½®æ–‡ä»¶æŒ‚è½½ -v /dascom/proxysql/db:/var/lib/proxysql \\ #æ•°æ®å­˜æ”¾ç›®å½•æŒ‚è½½ -d proxysql/proxysql:2.3.2 \\ å¯åŠ¨æœåŠ¡ï¼š\n./dascom-proxysql-deploy æŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸ\næ‰§è¡Œå‘½ä»¤ï¼š\ndocker ps --filter \u0026#34;name=dascom-proxysql\u0026#34; å‡ºç°STATUS æ˜¯UPçŠ¶æ€è¡¨ç¤ºå¯åŠ¨æˆåŠŸ\n::: ğŸ¤” ç«¯å£è¯´æ˜\nip: 6032 æ§åˆ¶å°çš„ç«¯å£ï¼Œæ¯”å¦‚ä½¿ç”¨SQLyogè¿æ¥å°±æ˜¯è¿è¿™ä¸ªç«¯å£ï¼Œæˆ–è€…ä½¿ç”¨MariaDBæœ¬æœºé€šè¿‡adminç”¨æˆ·è¿æ¥çš„ç«¯å£ ip:6033 é¡¹ç›®è¿æ¥çš„ç«¯å£ï¼Œ å’ŒMySQLé»˜è®¤çš„3306åˆšå¥½ç›¸å ip:6080 ProxySQL çš„webç›‘æ§ç«¯å£ï¼Œæµè§ˆå™¨è¾“å…¥ https://ip:6080 stats/statså¯ä»¥çœ‹åˆ°ä¸€äº›ç›‘æ§ä¿¡æ¯ï¼Œå¦‚è¿æ¥æ•°...ã€‚ æ³¨æ„æ˜¯httpsï¼ï¼ï¼ :::\nå››ã€æµ‹è¯•è¿æ¥ å¦‚æœæœ‰é˜²ç«å¢™ï¼Œéœ€è¦å¼€æ”¾ä¸Šé¢çš„ä¸‰ä¸ªç«¯å£\n#å¼€æ”¾ç«¯å£ firewall-cmd --zone=public --add-port=6033/tcp --permanent firewall-cmd --zone=public --add-port=6032/tcp --permanent firewall-cmd --zone=public --add-port=6080/tcp --permanent #é‡å¯é˜²ç«å¢™ systemctl restart firewalld ä½¿ç”¨å®¢æˆ·ç«¯è¿æ¥å·¥å…· SQLyog (å…¶ä»–ä¹Ÿè¡Œ)è¿æ¥6032ç«¯å£ã€‚\nè´¦å·å’Œå¯†ç æ˜¯ä¸Šé¢é…ç½®çš„\nusername: radmin password: radmin æ‰§è¡ŒsqlæŸ¥çœ‹é…ç½®ä¿¡æ¯\n#serversçš„é…ç½® SELECT * FROM mysql_servers; #é…ç½®çš„åç«¯ç”¨æˆ·ä¿¡æ¯ SELECT * FROM mysql_users; OKï¼ ä¸€åˆ‡å®Œæˆï¼ï¼ï¼ å…¶ä»–çš„æ•°æ®çš„æ“ä½œå’Œæ­£å¸¸çš„æ•°æ®åº“æ“ä½œä¸€æ ·ã€‚\n","permalink":"/posts/blog/mysql_cluster_deploy/","summary":"æ³¨ï¼šåªæä¾›éƒ¨ç½²ä¸‰å°MySQLæœåŠ¡å™¨çš„æµç¨‹ï¼ŒåŸºäºMySQLçš„MGRç‰¹æ€§ã€‚æ²¡æœ‰ä¸»ä»å…³ç³»ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€æ ·çš„ã€‚ éƒ¨ç½²å¤šå°çš„æœåŠ¡æ–¹å¼ä¸€æ ·ï¼Œåªéœ€ç®€å•çš„ä¿®æ”¹å‡ ä¸ªåœ°æ–¹çš„é…ç½®ã€‚ æ¡ˆä¾‹ç¯å¢ƒè¯´æ˜ èŠ‚ç‚¹ ip ç«¯å£ ä½œç”¨ èŠ‚ç‚¹1 (chenxiaoju3) 192.168.1.89 3306 MySQLéƒ¨ç½² èŠ‚ç‚¹2 (chenxiaoju4ï¼‰ 192.168.1.91 3306ï¼Œ6033 MySQLéƒ¨ç½²+P","title":"MySQLé›†ç¾¤éƒ¨ç½²"},{"content":"ä¸€ã€å‰è¨€ â€‹\tå› ä¸ºç°åœ¨çš„æ¶æ„é‡‡ç”¨çš„æ˜¯å•ä¸€æ•°æ®æºçš„å½¢å¼ï¼Œåœ¨å¹¶å‘è¯·æ±‚å¤§çš„æ—¶å€™ï¼Œåº”ç”¨æ˜¯å¯ä»¥é›†ç¾¤çš„ï¼Œæ‰€ä»¥åº”ç”¨å±‚ä¸æ˜¯æˆ‘ä»¬çš„ç“¶é¢ˆï¼Œè€Œæ•°æ®åº“å˜æˆäº†æˆ‘ä»¬çš„ç“¶é¢ˆï¼Œæ‰€ä»¥ä¹Ÿæä¾›æ•°æ®åº“é›†ç¾¤çš„æ–¹æ¡ˆã€‚\nâ€‹\tç›®å‰é‡‡ç”¨çš„æ•°æ®åº“æ˜¯MySQLï¼Œé’ˆå¯¹MySQLçš„é›†ç¾¤ï¼ŒMySQLè‡ªå·±å°±æä¾›äº†æ”¯æŒï¼Œå³ä¸»ä»å¤åˆ¶ï¼Œä»ä¸»ä»å¤åˆ¶ä¸­åˆå¼•ç”Ÿå‡ºäº†å¤šç§ä¸»ä»æ–¹æ¡ˆï¼Œå¦‚å•ä¸»å¤šä»ï¼Œå¤šä¸»å¤šä»\u0026hellip;ã€‚\nâ€‹\tåœ¨MySQLçš„ä¸»ä»å¤åˆ¶ä¸­ï¼Œæ€»æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ä¸å¯é¿å…çš„ï¼Œé‚£å°±æ˜¯ä»åº“çš„æ•°æ®å»¶è¿Ÿé—®é¢˜ï¼Œåªæ”¯æŒæ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ï¼Œæ ¹æ®å®é™…çš„æƒ…å†µï¼Œå¯èƒ½ä¼šå‡ºç°å‡ ç§’ç”šè‡³åˆ°å‡ å°æ—¶çš„å»¶è¿Ÿã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæœ‰ã€‚åœ¨MySQL5.7.17ç‰ˆæœ¬æ¨å‡ºäº†ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œé‚£å°±æ˜¯MySQL Group Replication ï¼ˆMGRï¼‰ç»„å¤åˆ¶ã€‚åŸºäºç»„çš„æ¦‚å¿µï¼ŒæŠŠä¸€ç¾¤æ•°æ®åº“æ”¾åˆ°ä¸€ç»„ä¸­ï¼Œå†™çš„æ•°æ®è¦ç­‰æ‰€æœ‰çš„æ•°æ®åº“éƒ½æäº¤äº†å†è¿”å›ï¼Œä½†æ˜¯åœ¨MGRä¸­ï¼Œè¿˜æ˜¯å­˜åœ¨æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ã€‚æ˜¯åœ¨MySQL8.0.14ç‰ˆæœ¬å¢åŠ äº†ä¸€ä¸ªæ–°ç‰¹æ€§ï¼šMGRè¯»å†™ä¸€è‡´æ€§ï¼›æ·»åŠ å‚æ•°group_replication_consistencæ¥æ§åˆ¶æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ã€‚é€šè¿‡é…ç½®è¯¥å‚æ•°çš„ä¸åŒå€¼ï¼Œå¯ä»¥å½»åº•çš„è¾¾åˆ°è¯»å†™ä¸€è‡´æ€§ã€‚\nâ€‹\tå¦‚æœä½¿ç”¨MGRï¼Œåœ¨å†™æ•°æ®çš„æ—¶å€™ï¼Œæ€§èƒ½ä¼šç•¥æœ‰ä¸‹é™ï¼ŒV10ä¸­ï¼Œè€ƒè™‘æˆ‘ä»¬åœ¨å†™æ•°æ®æ—¶æ˜¯å¯ä»¥å®¹å¿ä¸€éƒ¨åˆ†ï¼ˆå¦‚æœæ˜¯ä¸‰å°æœåŠ¡å™¨é›†ç¾¤ï¼Œå»¶é•¿å¤§çº¦å‡ åæ¯«ç§’ï¼‰ç­‰å¾…æ—¶é•¿çš„ï¼Œä½†æ˜¯æ•°æ®çš„ä¸€è‡´æ€§é—®é¢˜è¦å¾—ä»¥ä¿è¯ã€‚æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘é‡‡ç”¨MGRå¼ºè¯»å†™ä¸€è‡´æ€§ã€‚\näºŒã€æ•°æ®åº“ä»£ç† â€‹\tè¦ä½¿ç”¨å¤šå°çš„MySQLæ•°æ®åº“é›†ç¾¤ï¼Œé‚£ä¹ˆå°±éœ€è¦è€ƒè™‘ä»£ç†çš„é—®é¢˜ï¼Œè¦ç»Ÿä¸€è®¿é—®ç‚¹ã€‚åœ¨æ•°æ®åº“ä»£ç†è¿™ä¸€å—ï¼Œä¹Ÿæœ‰å¾ˆå¤šçš„è§£å†³æ–¹æ¡ˆï¼Œå¦‚ä¸»æµçš„ï¼š\nMycat : å¼€æºç¤¾åŒºç»´æŠ¤ï¼Œç”¨çš„äººæŒºå¤šçš„ï¼Œç¤¾åŒºä¹Ÿæ¯”è¾ƒæ´»è·ƒï¼Œä½†æ˜¯ç›®å‰å®˜æ–¹æä¾›çš„åªæ”¯æŒåˆ°5.7çš„ç‰ˆæœ¬ï¼Œç»è¿‡æµ‹è¯•ï¼Œæ”¯æŒMySQL8.0ä»¥ä¸Šéœ€è¦ä¿®æ”¹ä¸€ä¸‹æºç æ¥å…¼å®¹ã€‚\nMySQL-proxy : MySQLåŒæºäº§å“ï¼Œä½†æ˜¯åé¢åŸºæœ¬ä¸ç»´æŠ¤äº†ï¼Œä¸å°‘å…¶ä»–ä»£ç†ä¸­é—´ä»¶æ˜¯åœ¨å®ƒçš„åŸºç¡€ä¸ŠåŠ å¼ºçš„ã€‚\nAtlas ï¼š 360å¼€æºçš„ï¼Œç®—æ¯”è¾ƒæ´»è·ƒï¼ŒåŸºäºMySQL-proxyä¿®æ”¹çš„ã€‚\n\u0026hellip;\nâ€‹ ç„¶è€Œåœ¨å¯¹æ¯”å¤šä¸ªä¸­é—´ä»¶çš„åï¼Œæˆ‘ä»¬é‡‡ç”¨äº†å¦ä¸€ä¸ªä¸­é—´ä»¶ï¼ŒProxySQLã€‚ä¸€ä¸ªåŸºäºGPLåè®®å¼€æºçš„MySQLä»£ç†ä¸­é—´ä»¶ï¼Œæä¾›åŠ¨æ€é…ç½®ï¼Œç›‘æ§\u0026hellip;ç­‰ç­‰å¼ºå¤§çš„åŠŸèƒ½ï¼Œå¹¶ä¸”ç»´æŠ¤ä¹Ÿç¨³å®šï¼Œå„æ–‡æ¡£ä¹Ÿä¸°å¯Œã€‚\nä¸‰ã€æ¶æ„ ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬çš„æ•°æ®é›†ç¾¤æ¶æ„å›¾å¦‚ä¸‹ï¼š\nğŸ¤” è¯´æ˜\næ•°æ®åº“ä¸­é—´çš„ä»£ç†å±‚æ˜¯å¯ä»¥éšæ—¶å»æ‰çš„ï¼Œå»æ‰åæ•°æ®åº“å°±åªèƒ½ä½¿ç”¨å•å°ï¼Œä¸èƒ½ä½¿ç”¨å¤šå°æ•°æ®åº“åšè´Ÿè½½å‡è¡¡ã€‚ å››ã€éƒ¨ç½² MySQLé›†ç¾¤éƒ¨ç½²\ræ—¥æœŸ: 2023-03-27\r\u0026nbsp;\ræ ‡ç­¾:\r#MySQL\u0026nbsp;\ræ³¨ï¼šåªæä¾›éƒ¨ç½²ä¸‰å°MySQLæœåŠ¡å™¨çš„æµç¨‹ï¼ŒåŸºäºMySQLçš„MGRç‰¹æ€§ã€‚æ²¡æœ‰ä¸»ä»å…³ç³»ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€æ ·çš„ã€‚ éƒ¨ç½²å¤šå°çš„æœåŠ¡æ–¹å¼ä¸€æ ·ï¼Œåªéœ€ç®€å•çš„ä¿®æ”¹å‡ ä¸ªåœ°æ–¹çš„é…ç½®ã€‚ æ¡ˆä¾‹ç¯å¢ƒè¯´æ˜ èŠ‚ç‚¹ ip ç«¯å£ ä½œç”¨ èŠ‚ç‚¹1 (chenxiaoju3) 192.168.1.89 3306 MySQLéƒ¨ç½² èŠ‚ç‚¹2 (chenxiaoju4ï¼‰ 192.168.1.91 3306ï¼Œ6033 MySQLéƒ¨ç½²\u0026#43;P ......\r","permalink":"/posts/blog/mysql_cluster/","summary":"ä¸€ã€å‰è¨€ â€‹ å› ä¸ºç°åœ¨çš„æ¶æ„é‡‡ç”¨çš„æ˜¯å•ä¸€æ•°æ®æºçš„å½¢å¼ï¼Œåœ¨å¹¶å‘è¯·æ±‚å¤§çš„æ—¶å€™ï¼Œåº”ç”¨æ˜¯å¯ä»¥é›†ç¾¤çš„ï¼Œæ‰€ä»¥åº”ç”¨å±‚ä¸æ˜¯æˆ‘ä»¬çš„ç“¶é¢ˆï¼Œè€Œæ•°æ®åº“å˜æˆäº†æˆ‘ä»¬çš„ç“¶é¢ˆï¼Œæ‰€ä»¥ä¹Ÿæä¾›æ•°æ®åº“é›†ç¾¤çš„æ–¹æ¡ˆã€‚ â€‹ ç›®å‰é‡‡ç”¨çš„æ•°æ®åº“æ˜¯MySQLï¼Œé’ˆå¯¹MySQLçš„é›†ç¾¤ï¼ŒMySQLè‡ªå·±å°±æä¾›äº†æ”¯æŒï¼Œå³ä¸»ä»å¤åˆ¶ï¼Œä»ä¸»ä»å¤åˆ¶ä¸­åˆå¼•ç”Ÿ","title":"MySQLé›†ç¾¤æ–¹æ¡ˆ"},{"content":"é•œåƒç®¡ç† images docker images ï¼š åˆ—å‡ºæœ¬åœ°é•œåƒã€‚\ndocker images -a #åˆ—å‡ºæœ¬åœ°æ‰€æœ‰çš„é•œåƒ docker images -p #åªæ˜¾ç¤ºé•œåƒID è¯­æ³•ï¼š\ndocker images [OPTIONS] [REPOSITORY[ï¼šTAG]] OPTIONSè¯´æ˜ï¼š\n-a ï¼šåˆ—å‡ºæœ¬åœ°æ‰€æœ‰çš„é•œåƒï¼ˆå«ä¸­é—´æ˜ åƒå±‚ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿‡æ»¤æ‰ä¸­é—´æ˜ åƒå±‚ï¼‰ï¼› \u0026ndash;digests ï¼šæ˜¾ç¤ºé•œåƒçš„æ‘˜è¦ä¿¡æ¯ï¼› -f ï¼šæ˜¾ç¤ºæ»¡è¶³æ¡ä»¶çš„é•œåƒï¼› \u0026ndash;format ï¼šæŒ‡å®šè¿”å›å€¼çš„æ¨¡æ¿æ–‡ä»¶ï¼› \u0026ndash;no-trunc ï¼šæ˜¾ç¤ºå®Œæ•´çš„é•œåƒä¿¡æ¯ï¼› -q ï¼šåªæ˜¾ç¤ºé•œåƒIDã€‚ rmi docker rmi ï¼š åˆ é™¤æœ¬åœ°ä¸€ä¸ªæˆ–å¤šä¸ªé•œåƒã€‚\nè¯­æ³•ï¼š\ndocker rmi [OPTIONS] IMAGE [IMAGE...] OPTIONSè¯´æ˜ï¼š\n-f ï¼šå¼ºåˆ¶åˆ é™¤ï¼› \u0026ndash;no-prune ï¼šä¸ç§»é™¤è¯¥é•œåƒçš„è¿‡ç¨‹é•œåƒï¼Œé»˜è®¤ç§»é™¤ï¼› save docker save ï¼š å°†æŒ‡å®šé•œåƒä¿å­˜æˆ tar å½’æ¡£æ–‡ä»¶ã€‚\nè¯­æ³•ï¼š\ndocker save [OPTIONS] IMAGE [IMAGE...] OPTIONS è¯´æ˜ï¼š\n-o ï¼šè¾“å‡ºåˆ°çš„æ–‡ä»¶ã€‚ load docker load ï¼š å¯¼å…¥ä½¿ç”¨ docker save å‘½ä»¤å¯¼å‡ºçš„é•œåƒã€‚\nè¯­æ³•ï¼š\ndocker load [OPTIONS] OPTIONS è¯´æ˜ï¼š\n\u0026ndash;input , -i ï¼š æŒ‡å®šå¯¼å…¥çš„æ–‡ä»¶ï¼Œä»£æ›¿ STDINã€‚ \u0026ndash;quiet , -q ï¼š ç²¾ç®€è¾“å‡ºä¿¡æ¯ã€‚ å®¹å™¨æ“ä½œ ps docker ps ï¼š åˆ—å‡ºå®¹å™¨\nè¯­æ³•ï¼š\ndocker ps [OPTIONS] OPTIONSè¯´æ˜ï¼š\n-a ï¼šæ˜¾ç¤ºæ‰€æœ‰çš„å®¹å™¨ï¼ŒåŒ…æ‹¬æœªè¿è¡Œçš„ã€‚ -f ï¼šæ ¹æ®æ¡ä»¶è¿‡æ»¤æ˜¾ç¤ºçš„å†…å®¹ã€‚ \u0026ndash;format ï¼šæŒ‡å®šè¿”å›å€¼çš„æ¨¡æ¿æ–‡ä»¶ã€‚ -l ï¼šæ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨ã€‚ -n ï¼šåˆ—å‡ºæœ€è¿‘åˆ›å»ºçš„nä¸ªå®¹å™¨ã€‚ \u0026ndash;no-trunc ï¼šä¸æˆªæ–­è¾“å‡ºã€‚ -q ï¼šé™é»˜æ¨¡å¼ï¼Œåªæ˜¾ç¤ºå®¹å™¨ç¼–å·ã€‚ -s ï¼šæ˜¾ç¤ºæ€»çš„æ–‡ä»¶å¤§å°ã€‚ inspect docker inspect ï¼š è·å–å®¹å™¨/é•œåƒçš„å…ƒæ•°æ®ã€‚\nè¯­æ³•ï¼š\ndocker inspect [OPTIONS] NAME|ID [NAME|ID...] OPTIONSè¯´æ˜ï¼š\n-f ï¼šæŒ‡å®šè¿”å›å€¼çš„æ¨¡æ¿æ–‡ä»¶ã€‚ -s ï¼šæ˜¾ç¤ºæ€»çš„æ–‡ä»¶å¤§å°ã€‚ \u0026ndash;type ï¼šä¸ºæŒ‡å®šç±»å‹è¿”å›JSONã€‚ logs docker logs ï¼š è·å–å®¹å™¨çš„æ—¥å¿—\n#æŸ¥çœ‹å®¹å™¨mynginxä»2016å¹´7æœˆ1æ—¥åçš„æœ€æ–°10æ¡æ—¥å¿—ã€‚ docker logs --since=\u0026#34;2016-07-01\u0026#34; --tail=10 mynginx è¯­æ³•ï¼š\ndocker logs [OPTIONS] CONTAINER OPTIONSè¯´æ˜ï¼š\n-f ï¼šè·Ÿè¸ªæ—¥å¿—è¾“å‡º \u0026ndash;since ï¼šæ˜¾ç¤ºæŸä¸ªå¼€å§‹æ—¶é—´çš„æ‰€æœ‰æ—¥å¿— -t ï¼š æ˜¾ç¤ºæ—¶é—´æˆ³ \u0026ndash;tail ï¼šä»…åˆ—å‡ºæœ€æ–°Næ¡å®¹å™¨æ—¥å¿— top **docker top ï¼š**æŸ¥çœ‹å®¹å™¨ä¸­è¿è¡Œçš„è¿›ç¨‹ä¿¡æ¯ï¼Œæ”¯æŒ ps å‘½ä»¤å‚æ•°ã€‚\nè¯­æ³•ï¼š\ndocker top [OPTIONS] CONTAINER [ps OPTIONS] å®¹å™¨è¿è¡Œæ—¶ä¸ä¸€å®šæœ‰/bin/bashç»ˆç«¯æ¥äº¤äº’æ‰§è¡Œtopå‘½ä»¤ï¼Œè€Œä¸”å®¹å™¨è¿˜ä¸ä¸€å®šæœ‰topå‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨docker topæ¥å®ç°æŸ¥çœ‹containerä¸­æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ã€‚\nå®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç† run **docker run ï¼š**åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨å¹¶è¿è¡Œä¸€ä¸ªå‘½ä»¤\nè¯­æ³•ï¼š\ndocker run [OPTIONS] IMAGE [COMMAND] [ARG...] OPTIONSè¯´æ˜ï¼š\n-a stdinï¼š æŒ‡å®šæ ‡å‡†è¾“å…¥è¾“å‡ºå†…å®¹ç±»å‹ï¼Œå¯é€‰ STDIN/STDOUT/STDERR ä¸‰é¡¹ï¼› -dï¼š åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDï¼› -iï¼š ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ï¼› -Pï¼š éšæœºç«¯å£æ˜ å°„ï¼Œå®¹å™¨å†…éƒ¨ç«¯å£éšæœºæ˜ å°„åˆ°ä¸»æœºçš„ç«¯å£ -pï¼š æŒ‡å®šç«¯å£æ˜ å°„ï¼Œæ ¼å¼ä¸ºï¼šä¸»æœº(å®¿ä¸»)ç«¯å£ï¼šå®¹å™¨ç«¯å£ -tï¼š ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼› \u0026ndash;name=\u0026ldquo;nginx-lb\u0026rdquo;ï¼š ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼› \u0026ndash;dns 8.8.8.8ï¼šæŒ‡å®šå®¹å™¨ä½¿ç”¨çš„DNSæœåŠ¡å™¨ï¼Œé»˜è®¤å’Œå®¿ä¸»ä¸€è‡´ï¼› \u0026ndash;dns-search example.comï¼šæŒ‡å®šå®¹å™¨DNSæœç´¢åŸŸåï¼Œé»˜è®¤å’Œå®¿ä¸»ä¸€è‡´ï¼› -h \u0026ldquo;mars\u0026rdquo;ï¼šæŒ‡å®šå®¹å™¨çš„hostnameï¼› -e username=\u0026ldquo;ritchie\u0026rdquo;ï¼šè®¾ç½®ç¯å¢ƒå˜é‡ï¼› \u0026ndash;env-file=[]ï¼šä»æŒ‡å®šæ–‡ä»¶è¯»å…¥ç¯å¢ƒå˜é‡ï¼› \u0026ndash;cpuset=\u0026ldquo;0-2\u0026rdquo; or \u0026ndash;cpuset=\u0026ldquo;0,1,2\u0026rdquo;ï¼š ç»‘å®šå®¹å™¨åˆ°æŒ‡å®šCPUè¿è¡Œï¼› -m ï¼šè®¾ç½®å®¹å™¨ä½¿ç”¨å†…å­˜æœ€å¤§å€¼ï¼› \u0026ndash;net=\u0026ldquo;bridge\u0026rdquo;ï¼š æŒ‡å®šå®¹å™¨çš„ç½‘ç»œè¿æ¥ç±»å‹ï¼Œæ”¯æŒ bridge/host/none/containerï¼š å››ç§ç±»å‹ï¼› \u0026ndash;link=[]ï¼š æ·»åŠ é“¾æ¥åˆ°å¦ä¸€ä¸ªå®¹å™¨ï¼› \u0026ndash;expose=[]ï¼š å¼€æ”¾ä¸€ä¸ªç«¯å£æˆ–ä¸€ç»„ç«¯å£ï¼› \u0026ndash;volume , -vï¼š ç»‘å®šä¸€ä¸ªå· \u0026ndash;restart=alwaysï¼šå®¹å™¨éšdockerå¯åŠ¨ \u0026ndash;privileged=trueï¼š å®¹å™¨å†…çš„rootæ‹¥æœ‰çœŸæ­£çš„rootæƒé™ start/stop/restart ocker start ï¼šå¯åŠ¨ä¸€ä¸ªæˆ–å¤šä¸ªå·²ç»è¢«åœæ­¢çš„å®¹å™¨\ndocker stop ï¼šåœæ­¢ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨\ndocker restart ï¼šé‡å¯å®¹å™¨\nè¯­æ³•ï¼š\ndocker start [OPTIONS] CONTAINER [CONTAINER...] docker stop [OPTIONS] CONTAINER [CONTAINER...] docker restart [OPTIONS] CONTAINER [CONTAINER...] rm **docker rm ï¼š**åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ã€‚\nè¯­æ³•ï¼š\ndocker rm [OPTIONS] CONTAINER [CONTAINER...] OPTIONSè¯´æ˜ï¼š\n-f ï¼šé€šè¿‡ SIGKILL ä¿¡å·å¼ºåˆ¶åˆ é™¤ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ã€‚ -l ï¼šç§»é™¤å®¹å™¨é—´çš„ç½‘ç»œè¿æ¥ï¼Œè€Œéå®¹å™¨æœ¬èº«ã€‚ -v ï¼šåˆ é™¤ä¸å®¹å™¨å…³è”çš„å·ã€‚ exec **docker exec ï¼š**åœ¨è¿è¡Œçš„å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤\ndocker exec -it nginx bash #è¿›å…¥å®¹å™¨ è¯­æ³•ï¼š\ndocker exec [OPTIONS] CONTAINER COMMAND [ARG...] OPTIONSè¯´æ˜ï¼š\n-d ï¼šåˆ†ç¦»æ¨¡å¼ï¼š åœ¨åå°è¿è¡Œ -i ï¼šå³ä½¿æ²¡æœ‰é™„åŠ ä¹Ÿä¿æŒSTDIN æ‰“å¼€ -t ï¼šåˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ ä»“åº“ç®¡ç† ç™»å½•ä»“åº“\ndocker login --username=ä½ çš„ä»“åº“è®¾ç½®çš„ç”¨æˆ·å ä»“åº“åœ°å€ æ ‡è®°é•œåƒç‰ˆæœ¬\ndocker tag [imageId] ä»“åº“åœ°å€/é•œåƒåï¼šç‰ˆæœ¬å· æ¨é€é•œåƒ\ndocker push ä»“åº“åœ°å€/é•œåƒåï¼šç‰ˆæœ¬å· å…¶ä»–å‘½ä»¤ cp **docker cp ï¼š**ç”¨äºå®¹å™¨ä¸ä¸»æœºä¹‹é—´çš„æ•°æ®æ‹·è´ã€‚\nè¯­æ³•ï¼š\ndocker cp [OPTIONS] CONTAINERï¼šSRC_PATH DEST_PATH|- docker cp [OPTIONS] SRC_PATH|- CONTAINERï¼šDEST_PATH OPTIONSè¯´æ˜ï¼š\n-L ï¼šä¿æŒæºç›®æ ‡ä¸­çš„é“¾æ¥ stats docker statsï¼š ç”¨æ¥è¿”å›è¿è¡Œä¸­çš„å®¹å™¨çš„å®æ—¶æ•°æ®æµã€‚\nè¯­æ³•ï¼š\ndocker stats [OPTIONS] [CONTAINER...] OPTIONSè¯´æ˜ï¼š\n-a, \u0026ndash;all ï¼š æ˜¾ç¤ºæ‰€æœ‰å®¹å™¨(é»˜è®¤æ˜¾ç¤ºæ­£åœ¨è¿è¡Œ) \u0026ndash;format stringï¼š ä½¿ç”¨Goæ¨¡æ¿æ‰“å°æ¼‚äº®çš„å›¾åƒ \u0026ndash;no-streamï¼š ç¦ç”¨æµç»Ÿè®¡ï¼Œåªæå–ç¬¬ä¸€ä¸ªç»“æœ æŸ¥çœ‹æŸä¸ªå®¹å™¨å ç”¨å†…å­˜ docker ps #æŸ¥çœ‹å®¹å™¨IDï¼Œå¦‚ä¸º42efa33d1fa3 ps -ef | grep 42efa33d1fa3 #æŸ¥çœ‹æ­¤å®¹å™¨è¿›ç¨‹å·ï¼Œå‡è®¾ä¸º158666 pmap -d 158666æˆ–top -p 158666 #å³å¯æŸ¥çœ‹æ­¤å®¹å™¨å ç”¨å†…å­˜æƒ…å†µ ç»„åˆå‘½ä»¤ #åœæ­¢æ‰€æœ‰çš„containerï¼Œè¿™æ ·æ‰èƒ½å¤Ÿåˆ é™¤å…¶ä¸­çš„imagesï¼š docker stop $(docker ps -a -q) #å¦‚æœæƒ³è¦åˆ é™¤æ‰€æœ‰containerçš„è¯å†åŠ ä¸€ä¸ªæŒ‡ä»¤ï¼š docker rm $(docker ps -a -q) #è¦åˆ é™¤å…¨éƒ¨imageçš„è¯ docker rmi $(docker images -q) ğŸ¤” è¯´æ˜\næœ¬æ–‡åªåˆ—å‡ºä¸€äº›å¹³æ—¶æ¯”è¾ƒå¸¸ç”¨çš„å‘½ä»¤ï¼Œå…¶ä»–å‘½ä»¤å¯è‡ªè¡ŒæŸ¥è¯¢\n","permalink":"/posts/tech/docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/","summary":"é•œåƒç®¡ç† images docker images ï¼š åˆ—å‡ºæœ¬åœ°é•œåƒã€‚ docker images -a #åˆ—å‡ºæœ¬åœ°æ‰€æœ‰çš„é•œåƒ docker images -p #åªæ˜¾ç¤ºé•œåƒID è¯­æ³•ï¼š docker images [OPTIONS] [REPOSITORY[ï¼šTAG]] OPTIONSè¯´æ˜ï¼š -a ï¼šåˆ—å‡ºæœ¬åœ°æ‰€æœ‰çš„é•œåƒï¼ˆå«ä¸­é—´æ˜ åƒå±‚ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿‡æ»¤æ‰ä¸­é—´æ˜ åƒå±‚ï¼‰ï¼› \u0026ndash;digests ï¼šæ˜¾ç¤ºé•œåƒçš„æ‘˜è¦ä¿¡æ¯ï¼› -f ï¼šæ˜¾ç¤ºæ»¡è¶³æ¡ä»¶çš„é•œåƒï¼› \u0026ndash;format ï¼šæŒ‡å®šè¿”å›å€¼çš„","title":"Dockerå¸¸ç”¨å‘½ä»¤"},{"content":"æœ¬å®‰è£…æ•™ç¨‹æ˜¯åŸºäºCentos7ç‰ˆæœ¬çš„ã€‚å¹¶ä¸”ç³»ç»Ÿå·²ç»å®‰è£…äº†yumå·¥å…·ã€‚\nä¸€.å®‰è£… dockeræœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼ˆEEï¼‰ä¼ä¸šç‰ˆï¼Œ ï¼ˆCEï¼‰ç¤¾åŒºç‰ˆã€‚ ç¤¾åŒºç‰ˆæ˜¯å¼€æºå…è´¹çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å®‰è£…çš„æ˜¯ç¤¾åŒºç‰ˆçš„ã€‚\næ­¥éª¤å¦‚ä¸‹ï¼š\n1.å®‰è£… yum é…ç½®ç®¡ç†å·¥å…· yum install -y yum-utils device-mapper-persistent-data lvm2 2.è®¾ç½® Docker å®‰è£…æº yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo æ³¨ï¼š yum-config-managerå‘½ä»¤æ‰¾ä¸åˆ°çš„è§£å†³æ–¹æ³•ï¼Œå†æ‰§è¡Œä¸€éä»¥ä¸‹å‘½ä»¤\nyum install -y yum-utils 3.å®‰è£…docker-ceï¼Œ å®‰è£…æ­£åœ¨ä½¿ç”¨çš„ç‰ˆæœ¬ yum -y install docker-ce-19.03.1-3.el7 å…¶ä»–è¯´æ˜ï¼š\n# å®‰è£…æœ€æ–°ç‰ˆçš„docker-ce yum install -y docker-ce # æŸ¥çœ‹ä»“åº“ä¸­æ‰€æœ‰çš„dockerç‰ˆæœ¬ yum list docker-ce --showduplicates | sort -r 4.é…ç½®docker æ–°å»ºæˆ–ä¿®æ”¹: /etc/docker/daemon.json\n#å¦‚æœæ²¡æœ‰ç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºç›®å½• mkdir -p /etc/docker #æ‰“å¼€æ–‡ä»¶ vim /etc/docker/daemon.json æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\n{ \u0026#34;registry-mirrors\u0026#34;: [\u0026#34;https://zbcd7wks.mirror.aliyuncs.com\u0026#34;], \u0026#34;log-driver\u0026#34;:\u0026#34;json-file\u0026#34;, \u0026#34;log-opts\u0026#34;: {\u0026#34;max-size\u0026#34;:\u0026#34;500m\u0026#34;, \u0026#34;max-file\u0026#34;:\u0026#34;3\u0026#34;} } é…ç½®è¯´æ˜ï¼š\n#é…ç½®åŠ é€Ÿå™¨ { #dockerä¸­å›½å®˜æ–¹é•œåƒåŠ é€Ÿ \u0026#34;registry-mirrors\u0026#34;: [\u0026#34;https://registry.docker-cn.com\u0026#34;] #é˜¿é‡Œäº‘é•œåŠ é€Ÿå™¨ã€‚å› ä¸ºæˆ‘ä»¬çš„å‘å¸ƒé•œåƒå­˜åœ¨é˜¿é‡Œäº‘ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹‹é—´é…ç½®é˜¿é‡Œäº‘çš„é•œåƒåŠ é€Ÿ \u0026#34;registry-mirrors\u0026#34;: [\u0026#34;https://zbcd7wks.mirror.aliyuncs.com\u0026#34;] } #é…ç½®dockeræ—¥å¿— { \u0026#34;log-driver\u0026#34;:\u0026#34;json-file\u0026#34;, \u0026#34;log-opts\u0026#34;: {\u0026#34;max-size\u0026#34;:\u0026#34;500m\u0026#34;, \u0026#34;max-file\u0026#34;:\u0026#34;3\u0026#34;} } #é…ç½®æ—¥å¿—ï¼š #max-size=500mï¼Œæ„å‘³ç€ä¸€ä¸ªå®¹å™¨æ—¥å¿—å¤§å°ä¸Šé™æ˜¯500Mï¼Œ #max-file=3ï¼Œæ„å‘³ç€ä¸€ä¸ªå®¹å™¨æœ‰ä¸‰ä¸ªæ—¥å¿—ï¼Œåˆ†åˆ«æ˜¯id+.jsonã€id+1.jsonã€id+2.jsonã€‚ å¦‚æœæ˜¯å…¬å¸å†…éƒ¨ä½¿ç”¨å†…éƒ¨é•œåƒï¼Œéœ€è¦é…ç½®ç§æœåœ°å€\n#é…ç½®ç§æœçš„åœ°å€ { \u0026#34;insecure-registries\u0026#34;: [\u0026#34;192.168.1.33:1027\u0026#34;] } 5.å¯åŠ¨docker ä¸€å®šè¦ç¡®ä¿ç¬¬5æ­¥çš„æ ¼å¼æ²¡æœ‰é—®é¢˜ï¼Œå¦åˆ™ docker æ— æ³•å¯åŠ¨ï¼Œä¿®æ”¹å®Œæˆåæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\nsystemctl daemon-reload #é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ å¯åŠ¨å‘½ä»¤\nsystemctl enable docker #è®¾ç½®å¼€æœºå¯åŠ¨ systemctl start docker #å¯åŠ¨ systemctl disable docker #å…³é—­å¼€æœºå¯åŠ¨ æ³¨ï¼šéœ€è¦è®¾ç½®å¼€æœºå¯åŠ¨dockerã€‚å¦åˆ™æœåŠ¡å™¨é‡å¯ä¸ä¼šè‡ªåŠ¨å¯åŠ¨é¡¹ç›®\n6.æ£€æŸ¥æ˜¯å¦æˆåŠŸ æ‰§è¡Œå‘½ä»¤ï¼š\ndocker version å‡ºç°ä»¥ä¸‹å†…å®¹ï¼Œè¡¨ç¤ºå¯åŠ¨æˆåŠŸã€‚\n[root@chenxiaoju ~]# docker version Client: Docker Engine - Community Version: 20.10.8 API version: 1.40 Go version: go1.16.6 Git commit: 3967b7d Built: Fri Jul 30 19:55:49 2021 OS/Arch: linux/amd64 Context: default Experimental: true Server: Docker Engine - Community Engine: Version: 19.03.1 API version: 1.40 (minimum version 1.12) Go version: go1.12.5 Git commit: 74b1e89 Built: Thu Jul 25 21:19:36 2019 OS/Arch: linux/amd64 Experimental: false containerd: Version: 1.4.9 GitCommit: e25210fe30a0a703442421b0f60afac609f950a3 runc: Version: 1.0.1 GitCommit: v1.0.1-0-g4144b63 docker-init: Version: 0.18.0 GitCommit: fec3683 äºŒ.å¸è½½ 1.å¸è½½å®‰è£…åŒ… yum -y remove docker-ce yum list installed|grep docker æŸ¥çœ‹å®‰è£…çš„åŒ… #æŠŠæŸ¥åˆ°çš„éƒ½åˆ äº†ï¼Œå¦‚ä¸‹ï¼š yum â€“y remove docker.x86_64 yum â€“y remove docker-client.x86_64 yum â€“y remove docker-common.x86_64 2.å¸è½½åŸæ¥çš„æ—§æ•°æ® rm -rf /var/lib/docker dockerå¯åŠ¨å¤±è´¥çš„åŸå›  é”™è¯¯ä¿¡æ¯ï¼š\n[root@xxx]# systemctl start docker Job for docker.service failed because the control process exited with error code. See \u0026#34;systemctl status docker.service\u0026#34; and \u0026#34;journalctl -xe\u0026#34; for details. ä¸¤ä¸ªåŸå› ï¼š\n1.mkfs.xfsç‰ˆæœ¬å¤ªä½ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤\nyum update xfsprogs 2./etc/docker/daemon.jsonæ ¼å¼ä¸æ­£ç¡®\n","permalink":"/posts/tech/docker%E5%AE%89%E8%A3%85/","summary":"æœ¬å®‰è£…æ•™ç¨‹æ˜¯åŸºäºCentos7ç‰ˆæœ¬çš„ã€‚å¹¶ä¸”ç³»ç»Ÿå·²ç»å®‰è£…äº†yumå·¥å…·ã€‚ ä¸€.å®‰è£… dockeræœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼ˆEEï¼‰ä¼ä¸šç‰ˆï¼Œ ï¼ˆCEï¼‰ç¤¾åŒºç‰ˆã€‚ ç¤¾åŒºç‰ˆæ˜¯å¼€æºå…è´¹çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å®‰è£…çš„æ˜¯ç¤¾åŒºç‰ˆçš„ã€‚ æ­¥éª¤å¦‚ä¸‹ï¼š 1.å®‰è£… yum é…ç½®ç®¡ç†å·¥å…· yum install -y yum-utils device-mapper-persistent-data lvm2 2.è®¾ç½® Docker å®‰è£…æº yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo æ³¨ï¼š yum-config-manage","title":"Dockerå®‰è£…"},{"content":"ä¸€ã€ç›¸å…³æ¦‚å¿µ 1ã€webSocket WebSocketåè®®ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥ä¸»åŠ¨çš„æ¨é€æ¶ˆæ¯ï¼Œå¯ä»¥æ˜¯æ–‡æœ¬ä¹Ÿå¯ä»¥æ˜¯äºŒè¿›åˆ¶æ•°æ®\n2ã€SockJS JavaScriptçš„ä¸€ä¸ªå°è£…å·¥å…·åŒ…ï¼Œç”¨äºä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œå¦‚æœæµè§ˆå™¨æ”¯æŒwebSocket,é‚£ä¹ˆæµè§ˆå™¨å°±ä¼šä½¿ç”¨webSocketæ¥ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥ã€‚å¦åˆ™å°±é‡‡ç”¨ajaxè½®è¯¢æˆ–è€…æµè§ˆå™¨Streamæ¥è¿æ¥ã€‚\n3ã€STOMP STOMPå³ Simple (or Streaming) Text Orientated Messaging Protocol ç®€å•ï¼ˆæµï¼‰æ–‡æœ¬å®šå‘æ¶ˆæ¯åè®®ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªå¯äº’æ“ä½œçš„è¿æ¥æ ¼å¼ï¼Œå…è®¸STOMPå®¢æˆ·ç«¯ ä¸ä»»åŠ¡STOMPæ¶ˆæ¯ä»£ç†è¿›è¡Œäº¤äº’ã€‚\näºŒã€æœåŠ¡ç«¯ é‡‡ç”¨spring-mvc + spring-message\n1.é…ç½®web.xmlï¼ˆé…ç½®DispatcherServletï¼‰ \u0026lt;servlet\u0026gt; \u0026lt;servlet-name\u0026gt;dispatcher\u0026lt;/servlet-name\u0026gt; \u0026lt;servlet-class\u0026gt;org.springframework.web.servlet.DispatcherServlet\u0026lt;/servlet-class\u0026gt; \u0026lt;init-param\u0026gt; \u0026lt;param-name\u0026gt;contextConfigLocation\u0026lt;/param-name\u0026gt; \u0026lt;param-value\u0026gt;classpath:spring-websocket.xml\u0026lt;/param-value\u0026gt; \u0026lt;/init-param\u0026gt; \u0026lt;load-on-startup\u0026gt;1\u0026lt;/load-on-startup\u0026gt; \u0026lt;async-supported\u0026gt;true\u0026lt;/async-supported\u0026gt; \u0026lt;/servlet\u0026gt; \u0026lt;servlet-mapping\u0026gt; \u0026lt;servlet-name\u0026gt;dispatcher\u0026lt;/servlet-name\u0026gt; \u0026lt;url-pattern\u0026gt;/springmvc/*\u0026lt;/url-pattern\u0026gt; \u0026lt;!-- springmvc åªæ‹¦æˆª é…ç½®çš„è·¯å¾„ï¼ˆæ³¨æ„åœ¨urlè§£ææ—¶ä¼šè‡ªåŠ¨å»æ‰â€˜springmvcâ€™,æ‰€ä»¥å®¢æˆ·ç«¯è¯·æ±‚çš„urléœ€è¦åŠ ä¸Šè¿™é‡Œé…ç½®çš„\u0026#39;springmvc\u0026#39;ï¼‰ --\u0026gt; \u0026lt;/servlet-mapping\u0026gt; 2.é…ç½®spring-websocket.xml \u0026lt;context:component-scan base-package=\u0026#34;com.mustr\u0026#34;\u0026gt;\u0026lt;!-- åŒ…æ‰«æ--\u0026gt; \u0026lt;mvc:annotation-driven/\u0026gt; 3.é…ç½®WebSocketStompConfig package com.mustr.config; import org.springframework.context.annotation.Configuration; import org.springframework.messaging.simp.config.MessageBrokerRegistry; import org.springframework.web.socket.config.annotation.AbstractWebSocketMessageBrokerConfigurer; import org.springframework.web.socket.config.annotation.EnableWebSocketMessageBroker; import org.springframework.web.socket.config.annotation.StompEndpointRegistry; @Configuration @EnableWebSocketMessageBroker public class WebSocketStompConfig extends AbstractWebSocketMessageBrokerConfigurer { public void registerStompEndpoints(StompEndpointRegistry registry) { //ç›‘å¬ç«¯ç‚¹ registry.addEndpoint(\u0026#34;/endpoint\u0026#34;) .setAllowedOrigins(\u0026#34;*\u0026#34;)//å…è®¸æ‰€æœ‰çš„urlè®¿é—®ã€‚ .withSockJS();//å¯ç”¨SockJS } @Override public void configureMessageBroker(MessageBrokerRegistry registry) { // è¡¨æ˜åœ¨topicã€queueã€userè¿™äºŒä¸ªåŸŸä¸Šå¯ä»¥å‘å®¢æˆ·ç«¯å‘æ¶ˆæ¯ã€‚ registry.enableSimpleBroker(\u0026#34;/topic\u0026#34;, \u0026#34;/queue\u0026#34;, \u0026#34;/user/\u0026#34;); // å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘èµ·è¯·æ±‚æ—¶ï¼Œéœ€è¦ä»¥/appä¸ºå‰ç¼€ã€‚ registry.setApplicationDestinationPrefixes(\u0026#34;/app\u0026#34;); // ç»™æŒ‡å®šç”¨æˆ·å‘é€ä¸€å¯¹ä¸€çš„æ¶ˆæ¯å‰ç¼€æ˜¯/userã€‚ é»˜è®¤å°±æ˜¯user registry.setUserDestinationPrefix(\u0026#34;/user/\u0026#34;); //ä½¿ç”¨ActiveMQä½œä¸ºbrokeré…ç½® /*registry.enableStompBrokerRelay(\u0026#34;/topic\u0026#34;, \u0026#34;/queue\u0026#34;, \u0026#34;/user/\u0026#34;) .setRelayHost(\u0026#34;localhost\u0026#34;) .setRelayPort(61613)//ActiveMQ stompç«¯å£ .setClientLogin(\u0026#34;dascom\u0026#34;) .setClientPasscode(\u0026#34;dascom\u0026#34;); registry.setApplicationDestinationPrefixes(\u0026#34;/app\u0026#34;);*/ //å‘é€æ¶ˆæ¯æ—¶ï¼Œé‡‡ç”¨çº¿ç¨‹æ±  registry.configureBrokerChannel().taskExecutor(); } } ä¸‰ã€å®¢æˆ·ç«¯ 1.å¼•ç”¨ç›¸å…³çš„js \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;js/sockjs.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;js/stomp.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; 2.è¿æ¥æœåŠ¡å™¨ var url = \u0026#39;http://127.0.0.1:8080/trunk/springmvc/endpoint\u0026#39;; //æ³¨æ„springmvcä¸èƒ½å°‘ï¼ŒæœåŠ¡ç«¯è§£æä¼šè‡ªåŠ¨å»æ‰ var sock = new SockJS(url); var stomp = Stomp.over(sock); //stomp.debug = null;// ç¦ç”¨debugæ—¥å¿— stomp.connect({ è¯·æ±‚å¤´ï¼ˆå¯ä»¥ä¸ºnullï¼‰ },function(frame){ stomp.subscribe(\u0026#34;/user/123/mess\u0026#34;, testUserMess); stomp.subscribe(\u0026#34;/topic/test\u0026#34;, testTopic); //stomp.subscribe(\u0026#34;/topic\u0026#34;, topic); //stomp.subscribe(\u0026#34;/queue\u0026#34;, queue); //stomp.subscribe(\u0026#34;/queue/4433/class\u0026#34;, testQueue); }); function testTopic(message) { console.log(\u0026#34;/topic/test:\u0026#34; +message.body); } function testUserMess(message) { console.log(\u0026#34;/user/123/mess:\u0026#34; +message.body); } 3.Stomp API 3.1 connect() è¿æ¥æ–¹æ³• client.connect(login, passcode, connectCallback); client.connect(login, passcode, connectCallback, errorCallback); client.connect(login, passcode, connectCallback, errorCallback, host); loginï¼ˆç”¨æˆ·åï¼‰å’Œpasscodeï¼ˆå¯†ç ï¼‰æ˜¯stringsï¼ŒconnectCallbackå’ŒerrorCallbackåˆ™æ˜¯functionsã€‚ï¼ˆæœ‰äº›brokersï¼ˆä»£ç†ï¼‰è¿˜éœ€è¦ä¼ é€’ä¸€ä¸ªhostï¼ˆStringç±»å‹ï¼‰å‚æ•°ã€‚ï¼‰\nå¦‚æœä½ éœ€è¦é™„åŠ ä¸€ä¸ªheaderså¤´éƒ¨ï¼Œconnectæ–¹æ³•è¿˜æ¥å—å…¶ä»–ä¸¤ç§å½¢å¼çš„å‚æ•°ï¼š\nclient.connect(headers, connectCallback); client.connect(headers, connectCallback, errorCallback); //å¦‚æœä½ ä½¿ç”¨ä¸Šè¿°è¿™ç§æ–¹å¼ï¼Œä½ éœ€è¦è‡ªè¡Œåœ¨headersæ·»åŠ login,passcodeï¼ˆç”šè‡³hostï¼‰ï¼š //å¦‚ï¼š var headers = { login: \u0026#39;mylogin\u0026#39;, passcode: \u0026#39;mypasscode\u0026#39;, // additional header \u0026#39;client-id\u0026#39;: \u0026#39;my-client-id\u0026#39; }; client.connect(headers, connectCallback); headeræ˜¯mapå½¢å¼ï¼ŒconnectCallbackå’ŒerrorCallbackä¸ºfunctionsã€‚\n3.2 disconnect()æ–­å¼€è¿æ¥ client.disconnect(function() { //do something }; 3.3 send()å‘é€æ¶ˆæ¯ client.send(destination, {}, body);//ç›®çš„åœ°ï¼Œ è¯·æ±‚å¤´ ï¼Œ æ¶ˆæ¯ä½“ //å¦‚ï¼š client.send(\u0026#34;/topic/test\u0026#34;, {priority: 9}, \u0026#34;Hello, STOMP\u0026#34;); //clientä¼šå‘é€ä¸€ä¸ªSTOMPå‘é€å¸§ç»™/topic/testï¼Œè¿™ä¸ªå¸§åŒ…å«ä¸€ä¸ªè®¾ç½®äº†priorityä¸º9çš„headerå’Œå†…å®¹ä¸ºâ€œHello, STOMPâ€çš„bodyã€‚ 3.4è®¢é˜…ï¼ˆSubscribeï¼‰å’Œæ¥æ”¶ï¼ˆreceiveï¼‰æ¶ˆæ¯ ä½¿ç”¨subscribe()å»è®¢é˜…ã€‚è¿™ä¸ªæ–¹æ³•æœ‰2ä¸ªå¿…éœ€çš„å‚æ•°ï¼šç›®çš„åœ°(destination)ï¼Œå›è°ƒå‡½æ•°(callback)ï¼›è¿˜æœ‰ä¸€ä¸ªå¯é€‰çš„å‚æ•°headersã€‚å…¶ä¸­destinationæ˜¯Stringç±»å‹ï¼Œå¯¹åº”ç›®çš„åœ°ï¼Œå›è°ƒå‡½æ•°æ˜¯ä¼´éšç€ä¸€ä¸ªå‚æ•°çš„functionç±»å‹ã€‚\nvar subscription = client.subscribe(\u0026#34;/queue/test\u0026#34;, callback); subscribe()æ–¹æ³•è¿”å›ä¸€ä¸ªobjectï¼Œè¿™ä¸ªobjectåŒ…å«ä¸€ä¸ªidå±æ€§ï¼Œå¯¹åº”è¿™ä¸ªè¿™ä¸ªå®¢æˆ·ç«¯çš„è®¢é˜…IDã€‚è€Œunsubscribe()å¯ä»¥ç”¨æ¥å–æ¶ˆå®¢æˆ·ç«¯å¯¹è¿™ä¸ªç›®çš„åœ°destinationçš„è®¢é˜…ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰åœ¨headersé¢å¤–æ·»åŠ ï¼Œè¿™ä¸ªåº“ä¼šé»˜è®¤æ„å»ºä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„IDã€‚åœ¨ä¼ é€’headersè¿™ä¸ªå‚æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä½ è‡ªå·±çš„ID:\nvar mysubid = \u0026#39;...\u0026#39;; var subscription = client.subscribe(destination, callback, { id: mysubid }); è¿™ä¸ªå®¢æˆ·ç«¯ä¼šå‘æœåŠ¡ç«¯å‘é€ä¸€ä¸ªSTOMPè®¢é˜…å¸§ï¼ˆSUBSCRIBE frameï¼‰å¹¶æ³¨å†Œå›è°ƒäº‹ä»¶ã€‚æ¯æ¬¡æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯æ—¶ï¼Œå®¢æˆ·ç«¯éƒ½ä¼šè½®æµè°ƒç”¨å›è°ƒå‡½æ•°ï¼Œå‚æ•°ä¸ºå¯¹åº”æ¶ˆæ¯çš„STOMPå¸§å¯¹è±¡ï¼ˆFrame objectï¼‰ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š\ncallback = function(message) { // called when the client receives a STOMP message from the server if (message.body) { console.log(\u0026#34;got message with body \u0026#34; + message.body) } else { console.log(\u0026#34;got empty message\u0026#34;); } }); subscribe()æ–¹æ³•ï¼Œæ¥å—ä¸€ä¸ªå¯é€‰çš„headerså‚æ•°ç”¨æ¥æ ‡è¯†é™„åŠ çš„å¤´éƒ¨ã€‚\nvar headers = {ack: \u0026#39;client\u0026#39;, \u0026#39;selector\u0026#39;: \u0026#34;location = \u0026#39;Europe\u0026#39;\u0026#34;}; client.subscribe(\u0026#34;topic/test\u0026#34;, message_callback, headers); è¿™ä¸ªå®¢æˆ·ç«¯æŒ‡å®šäº†å®ƒä¼šç¡®è®¤æ¥æ”¶çš„ä¿¡æ¯ï¼Œåªæ¥æ”¶ç¬¦åˆè¿™ä¸ªselector : location = 'Europe'çš„æ¶ˆæ¯ã€‚\nå¦‚æœæƒ³è®©å®¢æˆ·ç«¯è®¢é˜…å¤šä¸ªç›®çš„åœ°ï¼Œä½ å¯ä»¥åœ¨æ¥æ”¶æ‰€æœ‰ä¿¡æ¯çš„æ—¶å€™è°ƒç”¨ç›¸åŒçš„å›è°ƒå‡½æ•°ï¼š\nonmessage = function(message) { // called every time the client receives a message } var sub1 = client.subscribe(\u0026#34;/topic/test\u0026#34;, onmessage); var sub2 = client.subscribe(\u0026#34;/topic/another\u0026#34;, onmessage) å¦‚æœè¦ä¸­æ­¢æ¥æ”¶æ¶ˆæ¯ï¼Œå®¢æˆ·ç«¯å¯ä»¥åœ¨subscribe()è¿”å›çš„objectå¯¹è±¡è°ƒç”¨unsubscribe()æ¥ç»“æŸæ¥æ”¶ã€‚\nvar subscription = client.subscribe(...); ... subscription.unsubscribe(); 3.5æ”¯æŒJSON STOMPæ¶ˆæ¯çš„bodyå¿…é¡»ä¸ºå­—ç¬¦ä¸²ã€‚å¦‚æœä½ éœ€è¦å‘é€/æ¥æ”¶JSONå¯¹è±¡ï¼Œä½ å¯ä»¥ä½¿ç”¨JSON.stringify()å’ŒJSON.parse()å»è½¬æ¢JSONå¯¹è±¡ã€‚\nvar quote = {symbol: \u0026#39;APPL\u0026#39;, value: 195.46}; client.send(\u0026#34;/topic/stocks\u0026#34;, {}, JSON.stringify(quote)); client.subcribe(\u0026#34;/topic/stocks\u0026#34;, function(message) { var quote = JSON.parse(message.body); console.log(quote.symbol + \u0026#34; is at \u0026#34; + quote.value); }; å››ã€nginxé…ç½® ä½¿ç”¨nginxåšä»£ç†çš„éœ€è¦çš„é…ç½®ä¾‹å­ï¼š\nupstream zp_server1{ #ip_hash; #server 127.0.0.1:8888; server 127.0.0.1:8080 weight=1; #server 127.0.0.1:805; server 127.0.0.1:806 weight=1; #server 127.0.0.1:807; #server 127.0.0.1:808; #server 127.0.0.1:809; } map $http_upgrade $connection_upgrade { default upgrade; \u0026#39;\u0026#39; close; } server { listen 80; server_name localhost; #charset koi8-r; #access_log logs/host.access.log main; location / { proxy_pass http://zp_server1; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection $connection_upgrade; } æ³¨æ„å…¶ä¸­mapï¼Œlocationéƒ¨åˆ†ã€‚\n","permalink":"/posts/tech/springboot%E9%9B%86%E6%88%90websocket/","summary":"ä¸€ã€ç›¸å…³æ¦‚å¿µ 1ã€webSocket WebSocketåè®®ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥ä¸»åŠ¨çš„æ¨é€æ¶ˆæ¯ï¼Œå¯ä»¥æ˜¯æ–‡æœ¬ä¹Ÿå¯ä»¥æ˜¯äºŒè¿›åˆ¶æ•°æ® 2ã€SockJS JavaScriptçš„ä¸€ä¸ªå°è£…å·¥å…·åŒ…ï¼Œç”¨äºä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œå¦‚æœæµè§ˆå™¨æ”¯æŒwebSocket,é‚£ä¹ˆæµè§ˆå™¨å°±ä¼šä½¿ç”¨webSocketæ¥ä¸æœåŠ¡å™¨å»º","title":"Springbooté›†æˆwebsocket"},{"content":"ä¸€ã€åˆ¶ä½œcxj-converteré•œåƒ è¿™ä¸ªé•œåƒæ˜¯æˆ‘è‡ªå·±åšçš„ï¼Œè¯¥å·¥å…·çš„å®˜æ–¹æä¾›äº†è‡ªå·±çš„é•œåƒï¼Œä½†æ˜¯éƒ½æ²¡æœ‰åŒ…å«å¤šä¸ªå·¥å…·çš„é•œåƒã€‚æ‰€æœ‰æˆ‘è‡ªå·±ç»“åˆä¸¤ä¸ªå·¥å…·ï¼Œåˆ¶ä½œä¸€ä¸ªåˆä½“é•œåƒã€‚\n2.1 Dockerfileå†…å®¹ FROM jrottenberg/ffmpeg:4.2-ubuntu1804 MAINTAINER chenxj\u0026lt;harry_mu@163.com\u0026gt; RUN apt-get clean \\ \u0026amp;\u0026amp; rm -rf /var/lib/apt/lists/* \\ \u0026amp;\u0026amp; apt-get update \\ \u0026amp;\u0026amp; apt-get install -y openjdk-8-jdk \\ ghostscript \\ libxinerama1 \\ libdbus-glib-1-2 \\ libcairo2 \\ libcups2 \\ libgl1-mesa-dri \\ libgl1-mesa-glx \\ libsm6 \\ fonts-opensymbol \\ hyphen-fr \\ hyphen-de \\ hyphen-en-us \\ hyphen-it \\ hyphen-ru \\ fonts-dejavu \\ fonts-dejavu-core \\ fonts-dejavu-extra \\ fonts-dustin \\ fonts-f500 \\ fonts-fanwood \\ fonts-freefont-ttf \\ fonts-liberation \\ fonts-lmodern \\ fonts-lyx \\ fonts-sil-gentium \\ fonts-texgyre \\ fonts-tlwg-purisa \\ curl \\ --no-install-recommends \\ \u0026amp;\u0026amp; apt-get clean \\ \u0026amp;\u0026amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* #æŠŠLibreofficeçš„å®‰è£…åŒ…æ‹·è´åˆ°æŒ‡å®šçš„ç›®å½•ä¸‹ COPY LibreOffice_6.4.7_Linux_x86-64_deb.tar.gz /tmp/lo/ #è§£å‹Libreofficeçš„å®‰è£…åŒ…ï¼Œå¹¶å®‰è£… RUN cd /tmp/lo \\ \u0026amp;\u0026amp; tar -zxvf LibreOffice_6.4.7_Linux_x86-64_deb.tar.gz --strip-components=1 \\ \u0026amp;\u0026amp; cd DEBS \\ \u0026amp;\u0026amp; dpkg -i *.deb \\ \u0026amp;\u0026amp; rm -fr /tmp/lo #æŠŠå­—ä½“ç›®å½•æ‹·è´åˆ°é•œåƒä¸­çš„æŒ‡å®šç›®å½•ä¸‹ï¼Œè§£å†³ä¸­æ–‡ä¹±ç é—®é¢˜ COPY fonts /usr/share/fonts/ RUN ln -s /opt/libreoffice6.4/program/soffice /usr/bin/soffice ENV PATH $PATH:/opt/libreoffice6.4/program ğŸ¤” æç¤º\ncxj-converteré•œåƒæ˜¯åŸºäºffmpeg:4.2çš„é•œåƒçš„ã€‚åœ¨æŠŠlibreofficeèå…¥åˆ°å…¶ä¸­å»ã€‚å…¶ä¸­ä¹ŸåŒ…å«äº†å®‰è£…jdkã€‚ å…¶ä¸­åŒ…å«çš„libreofficeçš„ç›¸å…³æ–‡ä»¶è·¯å¾„ï¼š\né“¾æ¥ï¼šhttps://pan.baidu.com/s/18HGdAfTe1pK5Lvor5TXQRg æå–ç ï¼šy0iz # å¦‚æœé“¾æ¥å¤±æ•ˆï¼ŒåŠ å¾®ä¿¡/QQè”ç³» äºŒã€ä½¿ç”¨æ¡ˆä¾‹ FH çš„Dockerfileæ–‡ä»¶ #åŸºç¡€é•œåƒ FROM 192.168.1.33:1027/cxj-converter MAINTAINER chenxj #é¡¹ç›®jaråŒ…çš„ä½ç½® ENV JAR_FILE=target/dascom-fh-10.0.0.jar #é»˜è®¤çš„jvmå¤§å° ENV JAVA_OPTS=\u0026#34;-Xms1024m -Xmx1024m\u0026#34; WORKDIR / #åˆ›å»ºå­˜æ”¾é¡¹ç›®çš„ç›®å½• RUN mkdir -p suite/config #æŠŠé¡¹ç›®æ–‡ä»¶æ‹·è´åˆ°å®¹å™¨ä¸­ COPY $JAR_FILE /suite/app.jar #æ—¶åŒºé—®é¢˜ RUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime RUN echo \u0026#39;Asia/Shanghai\u0026#39; \u0026gt;/etc/timezone #æš´éœ²8080ç«¯å£ EXPOSE 8080 WORKDIR /suite ENTRYPOINT exec java $JAVA_OPTS -jar app.jar $BOOT_OPTS å¯ä»¥çœ‹åˆ°ç¬¬äºŒè¡Œï¼ŒFROMäº†ä¸€ä¸ªåŸºç¡€é•œåƒã€‚è¿™ä¸ªé•œåƒå…¶å®å°±æ˜¯åŒ…å«äº†ffmpegå’ŒLibreoffice\nğŸ¤” å·¥å…·è¯´æ˜\nffmpeg: è§†é¢‘ï¼ŒéŸ³é¢‘...ç­‰å¤„ç†å·¥å…· Libreoffice:å¤„ç†æ–‡æ¡£è½¬æ¢çš„å·¥å…· å…¶ä»–çš„å‘½ä»¤å°±çœ‹æ³¨é‡Šå³å¯ã€‚\nğŸ¤” æ³¨æ„\n1. cxj-converterçš„ffmpeg, å‘½ä»¤åœ¨ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥æ‰§è¡Œ 2. liberofficeçš„officeHomeåœ¨/opt/libreoffice6.4ã€‚ å¦‚æœç»“åˆjodconverterå·¥å…·ä½¿ç”¨çš„è¯ï¼Œé…ç½® officeHome: /opt/libreoffice6.4 ","permalink":"/posts/blog/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%96%87%E4%BB%B6%E8%BD%AC%E6%8D%A2%E6%9C%8D%E5%8A%A1%E9%95%9C%E5%83%8F/","summary":"ä¸€ã€åˆ¶ä½œcxj-converteré•œåƒ è¿™ä¸ªé•œåƒæ˜¯æˆ‘è‡ªå·±åšçš„ï¼Œè¯¥å·¥å…·çš„å®˜æ–¹æä¾›äº†è‡ªå·±çš„é•œåƒï¼Œä½†æ˜¯éƒ½æ²¡æœ‰åŒ…å«å¤šä¸ªå·¥å…·çš„é•œåƒã€‚æ‰€æœ‰æˆ‘è‡ªå·±ç»“åˆä¸¤ä¸ªå·¥å…·ï¼Œåˆ¶ä½œä¸€ä¸ªåˆä½“é•œåƒã€‚ 2.1 Dockerfileå†…å®¹ FROM jrottenberg/ffmpeg:4.2-ubuntu1804 MAINTAINER chenxj\u0026lt;harry_mu@163.com\u0026gt; RUN apt-get clean \\ \u0026amp;\u0026amp; rm -rf /var/lib/apt/lists/* \\ \u0026amp;\u0026amp; apt-get update \\ \u0026amp;\u0026amp; apt-get install -y openjdk-8-jdk \\ ghostscript \\ libxinerama1 \\ libdbus-glib-1-2 \\ libcairo2 \\ libcups2 \\ libgl1-mesa-dri \\ libgl1-mesa-glx \\ libsm6 \\ fonts-opensymbol \\ hyphen-fr \\ hyphen-de \\ hyphen-en-us","title":"è‡ªå®šä¹‰æ–‡ä»¶è½¬æ¢æœåŠ¡é•œåƒ"},{"content":"","permalink":"/posts/life/life/","summary":"","title":"Life"},{"content":"","permalink":"/posts/read/read/","summary":"","title":"Read"},{"content":"å…³äºæˆ‘\nè‹±æ–‡å: mustr èŒä¸š: ç¨‹åºå‘˜ è¿åŠ¨: è·‘æ­¥ã€æˆ·å¤–ã€ç”µå­ç«æŠ€ ","permalink":"/about/","summary":"å…³äºæˆ‘ è‹±æ–‡å: mustr èŒä¸š: ç¨‹åºå‘˜ è¿åŠ¨: è·‘æ­¥ã€æˆ·å¤–ã€ç”µå­ç«æŠ€","title":"ğŸ™‹ğŸ»â€â™‚ï¸å…³äº"},{"content":"\ræ²ç é˜\rä¸€ä¸ªè®°å½•æŠ€æœ¯ã€é˜…è¯»ã€ç”Ÿæ´»çš„åšå®¢\râœ‰å‹é“¾æ ¼å¼\råç§°ï¼š æ²ç é˜ ç½‘å€ï¼š https://mustr.github.io/ å›¾æ ‡ï¼š https://mustr.github.io/img/Q.gif æè¿°ï¼š ä¸€ä¸ªè®°å½•æŠ€æœ¯ã€é˜…è¯»ã€ç”Ÿæ´»çš„åšå®¢ âœ‰å‹é“¾ç”³è¯·è¦æ±‚\rç§‰æ‰¿äº’æ¢å‹é“¾åŸåˆ™ã€æ–‡ç« å®šæœŸæ›´æ–°ã€ä¸èƒ½æœ‰å¤ªå¤šå¹¿å‘Šã€ä¸ªäººæè¿°å­—æ•°æ§åˆ¶åœ¨15å­—å†…\nğŸ»Hugoåšå®¢äº¤æµç¾¤\r937830864\n","permalink":"/links/","summary":"æ²ç é˜ ä¸€ä¸ªè®°å½•æŠ€æœ¯ã€é˜…è¯»ã€ç”Ÿæ´»çš„åšå®¢ âœ‰å‹é“¾æ ¼å¼ åç§°ï¼š æ²ç é˜ ç½‘å€ï¼š https://mustr.github.io/ å›¾æ ‡ï¼š https://mustr.github.io/img/Q.gif æè¿°ï¼š ä¸€ä¸ªè®°å½•æŠ€æœ¯ã€é˜…è¯»ã€ç”Ÿæ´»çš„åšå®¢ âœ‰å‹é“¾ç”³è¯·è¦æ±‚ ç§‰æ‰¿äº’æ¢å‹é“¾åŸåˆ™ã€æ–‡ç« å®šæœŸæ›´æ–°ã€ä¸èƒ½æœ‰å¤ªå¤šå¹¿å‘Šã€ä¸ªäººæè¿°å­—æ•°æ§åˆ¶åœ¨15å­—å†… ğŸ»Hugoåšå®¢äº¤æµç¾¤ 937830864","title":"ğŸ¤å‹é“¾"}]